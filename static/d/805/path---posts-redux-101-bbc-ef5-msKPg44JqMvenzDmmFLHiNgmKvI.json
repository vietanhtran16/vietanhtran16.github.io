{"data":{"site":{"siteMetadata":{"title":"Blog by Viet Anh Tran","subtitle":"Passionate about building software.","copyright":"Â© All rights reserved.","author":{"name":"Viet Anh Tran","email":"mail@vietanhtran.tech","github":"vietanhtran16","linkedin":"https://www.linkedin.com/in/viet-anh-tran-ba15a3a4/"},"disqusShortname":"vietanhtranblog","url":"https://vietanhtran16.github.io"}},"markdownRemark":{"id":"04697dc9-f3eb-5091-b318-7681e5abee57","html":"<p>Redux in simple term is a state container for JavaScript apps - not just for React. </p>\n<p>It allows consistency in your application since state of the whole application is store in a single immutable tree. Since it is immutable, the only way to update the state is to dispatch an action using a pure functions.</p>\n<h2>Basics of Redux</h2>\n<h3>Actions</h3>\n<ul>\n<li>Information that describes what type of action should be performed and what part of the state should be updated</li>\n<li>Describes what just happened in the application</li>\n<li>Due to that, <em>Type</em> property is a must-have in an action which would normally be a string constant</li>\n<li>The other property could be optinal based on what properties of the state you want to update</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//An action to add item to a note list</span>\n<span class=\"token punctuation\">{</span>\n    type<span class=\"token punctuation\">:</span> <span class=\"token string\">\"ADD_NOTE\"</span><span class=\"token punctuation\">,</span>\n    text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Set up meeting\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Action Creators</h3>\n<ul>\n<li>Are functions that create actions</li>\n<li>The results (actions) would then be passed into <em>dispatch</em> function to update the state of the store</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//Action creator for ADD_NOTE action</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">addNote</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        type<span class=\"token punctuation\">:</span> <span class=\"token string\">\"ADD_NOTE\"</span><span class=\"token punctuation\">,</span>\n        text<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">//Call dispatch to add note to store state</span>\n<span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">addNote</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>Reducers</h3>\n<ul>\n<li>Tranform current store state to the new state based on the actions</li>\n<li>This is how store state is updated in Redux</li>\n<li>Should always be pure functions - no side effect store state</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">reducer</span><span class=\"token punctuation\">(</span>currentState<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//Do something to update the state</span>\n    <span class=\"token keyword\">return</span> newState<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><em>myNote</em> reducer has <em>initialState</em> as it default store state. Inside the function, it looks at the type of the <em>action</em> to determine how store state is update. A completely new state object is returned by concatenating the current notes with the additional note from action. The changes should never be applied directly to the state but we should always return a new object to maintain its immutability.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//Create initial state of the store</span>\n<span class=\"token keyword\">const</span> initialState <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    notes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//myNote reducer</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">myNote</span><span class=\"token punctuation\">(</span>state <span class=\"token operator\">=</span> initialState<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">switch</span><span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">//Update notes property of store state</span>\n        <span class=\"token keyword\">case</span> <span class=\"token string\">\"ADD_NOTE\"</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n                    notes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                        <span class=\"token operator\">...</span>state<span class=\"token punctuation\">.</span>notes<span class=\"token punctuation\">,</span>\n                        action<span class=\"token punctuation\">.</span>text\n                    <span class=\"token punctuation\">]</span> \n                <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span> \n            <span class=\"token keyword\">return</span> state<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Splitting and combining reducers</h3>\n<p>Since your whole application has a single store, the store would have information of multiple parts of your application. If only one reducer handles state changes of the whole application, it will get out of hand very quickly. We could split the reducer so that each reducer handle a portion of the store state then use <em>combineReducers</em> to merge them into one.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//Initial state of the store</span>\n<span class=\"token keyword\">const</span> initialState <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    notes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    displayOnlyFive<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//Reducer that handles notes property of store state</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">notes</span><span class=\"token punctuation\">(</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">switch</span><span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">//Update notes property of store state</span>\n        <span class=\"token keyword\">case</span> <span class=\"token string\">\"ADD_NOTE\"</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n                    notes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                        <span class=\"token operator\">...</span>state<span class=\"token punctuation\">.</span>notes<span class=\"token punctuation\">,</span>\n                        action<span class=\"token punctuation\">.</span>text\n                    <span class=\"token punctuation\">]</span> \n                <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span> \n            <span class=\"token keyword\">return</span> state<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">//Reducer that handles displayOnlyFive property of store state</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">displayOnlyFive</span><span class=\"token punctuation\">(</span>state <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">switch</span><span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">case</span> <span class=\"token string\">\"DISPLAY_ONLY_FIVE_NOTES\"</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">return</span> action<span class=\"token punctuation\">.</span>displayOnlyFive<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span> \n            <span class=\"token keyword\">return</span> state<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span> \n\n<span class=\"token comment\">//Combine reducers</span>\n<span class=\"token keyword\">const</span> myNote <span class=\"token operator\">=</span> <span class=\"token function\">combineReducers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    notes<span class=\"token punctuation\">,</span>\n    displayOnlyFive<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//Which is the same as this</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">myNote</span><span class=\"token punctuation\">(</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    notes<span class=\"token punctuation\">:</span> <span class=\"token function\">notes</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">.</span>notes<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    displayOnlyFive<span class=\"token punctuation\">:</span> <span class=\"token function\">displayOnlyFive</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">.</span>displayOnlyFive<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>The lifecycle</h3>\n<ol>\n<li>\n<p><em>store.dispatch(action)</em> is called to send action object to the store</p>\n</li>\n<li>\n<p>The store will then pass current state and the action to the reducer</p>\n<ul>\n<li>The reducer will then return the next state</li>\n<li><em>dispatch</em> knows which reducer to use since we already wired up the reducer with the store as below</li>\n</ul>\n</li>\n<li>\n<p>Multiple reducers can be merged into one to create the state tree</p>\n</li>\n<li>\n<p>The store then saves the new state returned from the reducer</p>\n<ul>\n<li>Listeners that have been subscribed to the store will be invoked</li>\n</ul>\n</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> store <span class=\"token operator\">=</span> createStore<span class=\"token operator\">&lt;</span>IStoreState<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>reducer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><em>Reference:</em> <a href=\"https://redux.js.org/\">Redux</a></p>","fields":{"tagSlugs":["/tags/react/","/tags/redux/"],"slug":"/posts/redux-101/"},"frontmatter":{"title":"Redux 101","tags":["react","redux"],"date":"2018-01-10T16:51:00.000Z","description":"The basics of Redux"}}},"pageContext":{"slug":"/posts/redux-101/"}}